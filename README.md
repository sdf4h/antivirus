# antivirus

*pip install openai

















проект занял неделю и реализовал такие функции как

1. Функции в config.py
EMAIL_SETTINGS: Словарь с настройками для отправки email (SMTP сервер, порт, email отправителя, пароль и получатель).

KNOWN_MALICIOUS_HASHES: Список известных хешей вредоносных файлов.

TEXT_FILE_EXTENSIONS: Список расширений текстовых файлов.

BINARY_FILE_EXTENSIONS: Список расширений бинарных файлов.

2. Функции в email_notifier.py
send_email(subject, body):

Отправляет email с уведомлением.

Использует SMTP сервер и настройки из EMAIL_SETTINGS.

Логирует успешную отправку или ошибку.

3. Функции в scanner.py
log_result(message):

Записывает сообщения в лог-файл (logs/scan_log.txt).

calculate_hash(file_path):

Вычисляет хеш SHA-256 файла для сравнения с базой известных вредоносных хешей.

analyze_pe_file(file_path):

Анализирует PE-файлы (исполняемые файлы Windows) с помощью библиотеки pefile.

Возвращает информацию о секциях файла и их энтропии.

heuristic_analysis(file_path):

Проводит эвристический анализ файла на основе нескольких правил (размер, расширение, права доступа и т.д.).

Возвращает флаг подозрительности и список причин.

extract_strings(file_path):

Извлекает печатаемые строки из бинарных файлов.

Используется для анализа содержимого бинарных файлов.

scan_file(file_path):

Основная функция для сканирования файла.

Проверяет хеш файла, выполняет эвристический анализ, анализирует PE-файлы и извлекает строки из бинарных файлов.

Логирует результаты и отправляет уведомления по email при обнаружении подозрительных файлов.

4. Функции в main.py
get_user_email():

Запрашивает у пользователя email для уведомлений и сохраняет его в EMAIL_SETTINGS.

ChangeHandler (класс):

Обрабатывает события файловой системы (создание и изменение файлов).

При обнаружении изменений вызывает функцию scan_file для анализа файла.

start_monitoring(directory, scan_file_callback):

Запускает мониторинг изменений в указанной директории с помощью watchdog.

Использует ChangeHandler для обработки событий.

main():

Основная функция, которая:

Парсит аргументы командной строки (директория для сканирования).

Запрашивает email у пользователя.

Запускает сканирование директории.

Запускает мониторинг изменений в реальном времени.

5. Дополнительные функции (встроенные и из библиотек)
os.walk(directory):

Рекурсивно обходит директорию и возвращает список файлов и поддиректорий.

os.path.getsize(file_path):

Возвращает размер файла в байтах.

os.path.splitext(file_path):

Разделяет путь к файлу на имя и расширение.

os.stat(file_path):

Возвращает информацию о файле (например, права доступа).

time.sleep(seconds):

Приостанавливает выполнение программы на указанное количество секунд.

hashlib.sha256():

Используется для вычисления хеша SHA-256 файла.

re.compile(pattern):

Компилирует регулярное выражение для поиска строк в бинарных файлах.

pefile.PE(file_path):

Анализирует PE-файлы (исполняемые файлы Windows) с помощью библиотеки pefile.

6. Функции из библиотеки watchdog
Observer():

Класс для мониторинга изменений в файловой системе.

FileSystemEventHandler():

Базовый класс для обработки событий файловой системы (например, создание или изменение файлов).

observer.schedule(event_handler, path, recursive):

Регистрирует обработчик событий для указанной директории.

observer.start():

Запускает мониторинг изменений.

observer.stop():

Останавливает мониторинг.

7. Функции из библиотеки smtplib
smtplib.SMTP(smtp_server, smtp_port):

Создает соединение с SMTP сервером.

server.starttls():

Включает шифрование TLS для безопасной передачи данных.

server.login(email, password):

Авторизуется на SMTP сервере.

server.sendmail(from_email, to_email, message):

Отправляет email.

server.quit():

Закрывает соединение с SMTP сервером.

8. Функции из библиотеки email.mime.text
MIMEText(body):

Создает текстовое сообщение для отправки по email.
